# Network intrusion detection system: A systematic study of machine learning and deep learning approaches

## Intrusion Detection System
An [[Intrusion Detection System|IDS]] is the combination of two words “intrusion” and “detection system.” 
 - _Intrusion_ refers to an unauthorized access to the information within a computer or network systems to compromise its integrity, confidentiality, or availability. 
 - While _detection system_ is a security mechanism for the detection of such illegal activity. 
So, _IDS_ is a security tool that constantly monitors the host and network traffic to detect any suspicious behavior that violates the security policy and compromises its confidentiality, integrity, and availability. 
The IDS will generate alerts about detected malicious behavior to the host or network administrators. 
[[Passive deployment of network-based intrusion detection system.png|Figure]] below depicts a passive deployment of [[Network based Intrusion Detection System|NIDS]], where it is connected to a network switch configured with the port mirroring technology. 
 - The task is to mirror all the incoming and outgoing network traffic to NIDS for performing traffic monitoring to detect intrusions. 
 - NIDS can also be deployed in between the firewall and the network switch to allow all the traffic to pass through NIDS.

![[Passive deployment of network-based intrusion detection system.png]]

--------------------------------
## Classification of IDS
- #### Deployment method based IDS
	- [[Host-based Intrusion Detection System|Host-based IDS]]
	- [[Network based Intrusion Detection System|Network based IDS]]
- #### Detection method based IDS
	- [[Signature based Intrusion Detection System|Signature based IDS]]
	- [[Anomaly Intrusion Detection System|Anomaly detection based IDS]]

![[Intrusion detection system classification taxonomy.png]]

------------------------

## Usage in IoT
The popularity of the [[Internet of Things|IoT]] paradigm due to network technologies advancement has resulted in exponential growth in the use of IoT devices. One of the vital technology used in the development of an IoT network is the [[Wireless Sensor Network|WSN]], which comprises of a collection of sensor nodes for information collection. A huge amount of critical information is collected by these IoT sensor devices and is shared over the internet. This big data along with the complex structure of WSN comprising of the resource-limited sensor nodes causes security challenges for the IoT network. To this end, IDS is considered as one of the effective mechanism for the security of IoT and WSN. Many different IDS approaches are proposed in the literature, which are based on the efficient use of watchdogs, trust models, and game-theoretic concepts.

### Watchdogs
Watchdogs are the network nodes that are assigned the task of watching and monitoring the neighboring nodes' network traffic. Then a decision is made regarding the misbehaving nodes by using some set of rules. Many solutions are proposed for the anomaly and intrusion detection using watchdogs in the domain of WSN, AdHoc networks, and IoT.

### Trust models
Trust models are another tool used to improve the performance of an IDS. An IDS based on the trust model evaluates the trustworthiness of their nodes to identify the malicious nodes by constantly mentoring the network traffic for abnormal behaviors. In the context of IoT, a trust management scheme can be used in a distributed manner to reduce the computational overheads of resource-constrained sensor nodes.

### Game Theory
Game theory is widely used for the efficient designing of IDS. It is an applied mathematical concept used to model the strategic interactions among the players by describing a game. Each game includes the set of players and each player has a set of strategies along with an action plan and payoff for each action within a game. The solution of the game is based on an equilibrium state which is based on the player's strategy to maximize the payoff. A game can be cooperative or noncooperative depending upon entities' interaction cooperatively or competitively. From the perspective of IDS for IoT and WSN, a game is modeled between the attackers and the defenders either by their interaction or by using the prediction strategy of an attacker.

-------
# AI methods for NIDS
A NIDS developed using ML and DL methods usually involves following three major steps as depicted in Figure below, that is, (i) [[Data pre-processing]] phase, (ii) Training phase, and (iii) Testing phase.
![[Generalized ML or DL based NIDS methodology.png]]

## ML Algorithms
ML is a subset of AI that includes all the methods and algorithms which enable the machines to learn automatically using mathematical models in order to extract useful information from the large datasets.
 - #### Decision Tree ![[Decision Tree]]
 - #### K-Nearest Neighbor ![[K-Nearest Neighbor]]
-----
# Studies Comparison


|                                                  Study                                                   |                                                         Methodology                                                         | Strengths                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Weaknesses                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| :------------------------------------------------------------------------------------------------------: | :-------------------------------------------------------------------------------------------------------------------------: | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|        Yin et al[91](https://onlinelibrary.wiley.com/doi/full/10.1002/ett.4150#ett4150-bib-0091)         |                                                  Recurrent Neural Network                                                   | A NIDS based on RNN model is proposed that achieves higher performance in terms of detection accuracy using ML algorithms                                                                                                                                                                                                                                                                                                                                                   | The model has increased complexity and requires more time for training. Also, it uses an older dataset NSL-KDD for model evaluation. Results demonstrate lower detection rates for minority attack classes like R2L and U2R.                                                                                                                                                                                                                       |
|        Shen et al[81](https://onlinelibrary.wiley.com/doi/full/10.1002/ett.4150#ett4150-bib-0081)        |                                    Ensemble Method with Optimization using BAT algorithm                                    | An idea of using a BAT optimization algorithm together with the Ensemble method based on ELM as the base classifier. Many ELMs combined in an Ensemble way outperform individual ELM performance.                                                                                                                                                                                                                                                                           | The use of old datasets KDD Cup'99, NSL-KDD, and Kyoto for model evaluation. Moreover, the model achieves lower detection accuracy for the U2R attack class.                                                                                                                                                                                                                                                                                       |
|       Shone et al[97](https://onlinelibrary.wiley.com/doi/full/10.1002/ett.4150#ett4150-bib-0097)        |                                     Non Symmetric Deep Auto Encoder with Random Forest                                      | Proposed a NIDS model using a non-symmetric deep AE and RF classifier. The complexity of the model is reduced by using non-symmetric deep AE for efficient feature selection.                                                                                                                                                                                                                                                                                               | The model is evaluated using old datasets KDD Cup'99 and NSL-KDD. The model performance for minority classes R2L and U2R is on the lower side.                                                                                                                                                                                                                                                                                                     |
|        Ali et al[79](https://onlinelibrary.wiley.com/doi/full/10.1002/ett.4150#ett4150-bib-0079)         |                                     Fast Learning Network and Particle Swarm Algorithm                                      | Use of FLN and particle swarm optimization algorithm for proposing a NIDS model. The proposed model showed better performance than other models based on FLN with different other optimization algorithms.                                                                                                                                                                                                                                                                  | The model is tested using a very old dataset KDD Cup'99. Also, the detection rate for the attack class with less training data (R2L and U2R) is low.                                                                                                                                                                                                                                                                                               |
|        Jia et al[109](https://onlinelibrary.wiley.com/doi/full/10.1002/ett.4150#ett4150-bib-0109)        |                                                     Deep Neural Network                                                     | Proposed a NIDS based on DNN with four hidden layers that have shown superior performance than IDS based on ML methods.                                                                                                                                                                                                                                                                                                                                                     | For validating the model, older datasets KDD cup'99 and NSLKDD are used. Also, lower detection accuracy for the U2R attack class is recorded.                                                                                                                                                                                                                                                                                                      |
|       Wang et al[111](https://onlinelibrary.wiley.com/doi/full/10.1002/ett.4150#ett4150-bib-0111)        |                                                     Deep Neural Network                                                     | Studied the effect of DNN-based IDS against adversaries and evaluated the state-of-the-art attack algorithms against DNN based intrusion detection on the NSL-KDD dataset.                                                                                                                                                                                                                                                                                                  | Use of older dataset NSLKDD for validation purposes.                                                                                                                                                                                                                                                                                                                                                                                               |
|        Yan et al[67](https://onlinelibrary.wiley.com/doi/full/10.1002/ett.4150#ett4150-bib-0067)         |                                                Sparse Auto Encoder with SVM                                                 | Efficient use of stacked sparse autoencoder (SSAE) for feature extraction and SVM as a classifier to propose a NIDS.                                                                                                                                                                                                                                                                                                                                                        | An older dataset NSL-KDD is used for evaluating the model. The model achieves reasonable detection rates for U2R and R2L attacks but it is still lower comparing the other attack classes of the dataset.                                                                                                                                                                                                                                          |
|       Naseer et al[94](https://onlinelibrary.wiley.com/doi/full/10.1002/ett.4150#ett4150-bib-0094)       |                                   Comparison between different ML and DL-based IDS Models                                   | Comparison of ML- and DL-based NIDS algorithms by implementing on GPU-integrated testbed.                                                                                                                                                                                                                                                                                                                                                                                   | Use of an older dataset NSL-KDD for evaluation.                                                                                                                                                                                                                                                                                                                                                                                                    |
|         Xu et al[93](https://onlinelibrary.wiley.com/doi/full/10.1002/ett.4150#ett4150-bib-0093)         |                    Neural Network using gated Recurrent Units as memory with Multiple Layer Perception.                     | Use of GRU as the main memory for RNN together with the multilayer perceptron and a softmax classifier to propose a NIDS solution.                                                                                                                                                                                                                                                                                                                                          | The model is evaluated using old datasets KDD Cup'99 and NSL-KDD. Also, lower detection rates for R2L and U2R attack classes are recorded.                                                                                                                                                                                                                                                                                                         |
|      Al-Qatf et al[99](https://onlinelibrary.wiley.com/doi/full/10.1002/ett.4150#ett4150-bib-0099)       |                               Self Taught Learning Model based on Sparse Auto Encoder and SVM                               | The proposal of a NIDS by an efficient idea of self-taught learning based on Sparse AE and SVM.                                                                                                                                                                                                                                                                                                                                                                             | The model is tested using an older dataset NSL-KDD. Also, no results are provided for the performance of the model against minority attack classes (e.g. R2L and U2R).                                                                                                                                                                                                                                                                             |
|       Marir et al[120](https://onlinelibrary.wiley.com/doi/full/10.1002/ett.4150#ett4150-bib-0120)       |                                                 Deep Belief Network and SVM                                                 | Use of DBN and ensemble SVM to detect abnormal behavior in a distributed way. DBN is used for feature extraction, which is then forwarded to the ensemble SVM and finally, the voting mechanism is used for prediction.                                                                                                                                                                                                                                                     | The model is complex and the training time increases slightly for deeper layers.                                                                                                                                                                                                                                                                                                                                                                   |
| Papamartizivanous et al[100](https://onlinelibrary.wiley.com/doi/full/10.1002/ett.4150#ett4150-bib-0100) |                                      Self Taught Learning based on Sparse Auto Encoder                                      | Propose an autonomous misuse detection system by combining the self-taught learning and MAPE-K frameworks. For learning useful features, a sparse AE is used.                                                                                                                                                                                                                                                                                                               | The proposed model is validated using old datasets KDD Cup'99 and NSLKDD. Also, it shows the incapability of detecting R2L and U2R attack classes                                                                                                                                                                                                                                                                                                  |
|       Khan et al[103](https://onlinelibrary.wiley.com/doi/full/10.1002/ett.4150#ett4150-bib-0103)        |                                         Two-Stage Model using Stacked Auto Encoder                                          | Propose an efficient two-stage NIDS model based on deep stacked AE. The result of the first stage along with the obtained probability scores are input the final decision stage as an additional feature to improve for normal and multiclass attack classification. The use of different methodologies (downsampling/SMOTE for different datasets) during the preprocessing of the dataset dramatically improves the detection rate efficiency of minority attack classes. | For evaluation purposes, KDD Cup'99 and UNSW-NB15 datasets are used. The detection accuracy for KDD Cup'99 is 99.996% while for the UNSW-NB15 dataset detection accuracy is 89.134% which suggests that although the model performed well for an older dataset, however for the relatively newer dataset, the detection accuracy is decreased by almost 10%. Further, it is not shown how the model performs in detecting minority attack classes. |
|       Xiao et al[123](https://onlinelibrary.wiley.com/doi/full/10.1002/ett.4150#ett4150-bib-0123)        |        Convolutional Neural Network with Principal component analysis (PCA) and Auto Encoder for dimension reduction        | An efficient NIDS is proposed based on the DL algorithm CNN. For dimensionality reduction, feature extraction is performed considering PCA and AE.                                                                                                                                                                                                                                                                                                                          | The performance of the proposed model is evaluated using an older dataset KDD Cup'99. Moreover, the model achieves lower detection rates for the U2R and R2L classes.                                                                                                                                                                                                                                                                              |
|        Yao et al[72](https://onlinelibrary.wiley.com/doi/full/10.1002/ett.4150#ett4150-bib-0072)         |                             A Multilevel Model based on _K_-Means Clustering and Random Forest                              | A clustering concept is used along with RF to propose a multilevel intrusion detection model. The model exhibits superior performance in detecting the attacks even with low instances in the dataset.                                                                                                                                                                                                                                                                      | Use of a very old dataset KDD Cup'99 for model validation purposes.                                                                                                                                                                                                                                                                                                                                                                                |
|    Vinayakumar et al[116](https://onlinelibrary.wiley.com/doi/full/10.1002/ett.4150#ett4150-bib-0116)    |                                                     Deep Neural Network                                                     | A hybrid scalable DNN framework called scale-hybrid-IDS-AlertNet is proposed for effective real-time monitoring of network traffic to detect intrusions. The model is tested using different new and old datasets.                                                                                                                                                                                                                                                          | A complex model which gives a lower detection rate performance for minority attack class.                                                                                                                                                                                                                                                                                                                                                          |
|        Gao et al[82](https://onlinelibrary.wiley.com/doi/full/10.1002/ett.4150#ett4150-bib-0082)         |                                   Ensemble Machine Learning methods with Voting algorithm                                   | Use of an adaptive ensemble model by using several base classifiers as decision tree, RF, K-Nearest Neighbor, DNN, and choosing the best classifier using an adaptive voting algorithm.                                                                                                                                                                                                                                                                                     | Model is tested using an older dataset NSL-KDD which exhibits unsatisfactory results for weaker attack classes.                                                                                                                                                                                                                                                                                                                                    |
|        Wei et al[121](https://onlinelibrary.wiley.com/doi/full/10.1002/ett.4150#ett4150-bib-0121)        |          Deep Belief Network along with optimization algorithms Particle Swarm, Fish Swarm and Genetic Algorithms.          | Proposed a DL-based model DBN, and is optimized by combining the different optimization algorithms as Particle Swarm, Fish swarm, and Genetic Algorithm.                                                                                                                                                                                                                                                                                                                    | The proposed model is complex and requires more training time. Furthermore, it is evaluated using an older dataset NSL-KDD.                                                                                                                                                                                                                                                                                                                        |
|       Zhang et al[124](https://onlinelibrary.wiley.com/doi/full/10.1002/ett.4150#ett4150-bib-0124)       |                                          Multi Layer Convolutional Neural Network                                           | A multilayer NIDS model based on CNN and gcForest is proposed. Also, for converting raw data into a two-dimensional greyscale image, a novel P-Zigzag algorithm is proposed. The model is evaluated using by combining new datasets UNSW-NB15 and CIC-IDS2017.                                                                                                                                                                                                              | The detection accuracy for the attack classes with less training data is low.                                                                                                                                                                                                                                                                                                                                                                      |
|      Malaiya et al[104](https://onlinelibrary.wiley.com/doi/full/10.1002/ett.4150#ett4150-bib-0104)      | Model based on Fully Connected Networks (FCNs), Variational AutoEncoder (VAE),and Sequence-to-Sequence (Seq2Seq) structures | Different models for ID detection is proposed using fully connected networks, Variational AE, and Seq2Seq structures, respectively. Both new and older datasets are used for model evaluation purposes.                                                                                                                                                                                                                                                                     | The Seq2Seq model performs best among other models at the cost of greater training overhead than others. Moreover, it is not shown which model performs best in the detection of the minority attack classes.                                                                                                                                                                                                                                      |
|      Karatas et al[63](https://onlinelibrary.wiley.com/doi/full/10.1002/ett.4150#ett4150-bib-0063)       |        Performance Comparison of different ML algorithm by first reducing the dataset imbalance ratio using (SMOTE)         | The analysis of six ML-based NIDSs is presented that addresses dataset imbalance by reducing the imbalance ratio using SMOTE. This eventually improves the detection rate for the minority attack class. Also, an up to date dataset CSECIC-IDS2018 is used for evaluation.                                                                                                                                                                                                 | Adaboost algorithm is shown to achieve higher detection accuracy, but it is done at the cost of higher execution time.                                                                                                                                                                                                                                                                                                                             |
|       Jiang et al[125](https://onlinelibrary.wiley.com/doi/full/10.1002/ett.4150#ett4150-bib-0125)       |                                      Deep Hierarchical Network based on CNN and BiLSTM                                      | An IDS is proposed using CNN and bi-directional long short-term memory (BiLSTM) in a deep hierarchy. The class imbalance problem is addressed by using SMOTE to increase the minority samples. Evaluation is performed using both older (NSL-KDD) and newer (UNSW-NB15) datasets.                                                                                                                                                                                           | The proposed model is complex and the detection rate of minority data classes improved slightly but still, it is very low comparing other attack classes.                                                                                                                                                                                                                                                                                          |
|       Yang et al[106](https://onlinelibrary.wiley.com/doi/full/10.1002/ett.4150#ett4150-bib-0106)        |         Supervised adversarial Variational Auto Encoder with regularization (SAVAER) and Deep Neural Network (DNN)          | A NIDS is proposed based on the supervised adversarial variational AE with regularization and DNN. Evaluation is performed using both older (NSL-KDD) and newer (UNSW-NB15) datasets.                                                                                                                                                                                                                                                                                       | For the NSL-KDD dataset, the model achieves reasonable detection rates for U2R and R2L attacks but it is still lower comparing the other attack classes of the dataset. For the UNSW-NB15 dataset, the model performance for the detection of minority class attacks is not shown.                                                                                                                                                                 |
|        Yu et al[126](https://onlinelibrary.wiley.com/doi/full/10.1002/ett.4150#ett4150-bib-0126)         |                                          Few Shot Learning (FSL) using DNN and CNN                                          | An efficient NIDS model is proposed based on the novel DL idea of Few-shot Learning (FSL). DL algorithms as DNN and CNN are adopted as embedding functions in the model for extracting the essential feature and reducing the dimension. The model is evaluated using NSL-KDD and UNSW-NB15 datasets.                                                                                                                                                                       | For the NSL-KDD dataset, the model achieves reasonable detection rates for U2R and R2L attacks but it is still lower comparing the other attack classes of the dataset. Also, FSL requires labeled data for learning which makes its application limited in scenarios, where the model is trained frequently using the unlabeled network traffic to help it learn more patterns for effective detection.                                           |
|     Andresini et al[107](https://onlinelibrary.wiley.com/doi/full/10.1002/ett.4150#ett4150-bib-0107)     |                                               Multistage Auto Encoder and CNN                                               | Use of AE to proposed a multi-stage model involving the intrusion detection convolution layer and two stacked fully connected layers. Also, the model's performance is tested using both new and older datasets.                                                                                                                                                                                                                                                            | The model's effectiveness in detecting the minority attack class is not given. Also, the model is unable to provide details about the structure and characteristics of the attack.                                                                                                                                                                                                                                                                 |
